#@package _global_

defaults:
  - /data: pastis_subpatched
  - /model: prithvi_segmentation

tags: ["finetunning", "prithvi_segmentation"]

data:
  train:
    transforms:
      - _target_: src.data.transforms.loose_bind_transform
        transform:
          _target_: src.data.transforms.Take
          _partial_: True
          indices: [1, 2, 3, 7, 8, 9]
          dim: 1
      - _target_: src.data.transforms.loose_bind_transform
        transform:
          _target_: src.data.transforms.Reshape
          _partial_: True
          shape: [-1, 128, 128]
  val:
    transforms:
      - _target_: src.data.transforms.loose_bind_transform
        transform:
          _target_: src.data.transforms.Take
          _partial_: True
          indices: [1, 2, 3, 7, 8, 9]
          dim: 1
      - _target_: src.data.transforms.loose_bind_transform
        transform:
          _target_: src.data.transforms.Reshape
          _partial_: True
          shape: [-1, 128, 128]

model:
  net:
    img_size: 128
    num_classes: 20

  criterion:
    _target_: torch.nn.CrossEntropyLoss
    ignore_index: 0
  
trainer:
  gradient_clip_val: 0.1
    